p8105_HW2_cw3555
================
Eunice Wang
2023-10-04

``` r
library(tidyverse)
library(readxl)
```

## Problem 1

First, clean the data in *pols-month.csv*.

``` r
pols_df =
  read_csv("./fivethirtyeight_datasets/pols-month.csv") |>
  janitor::clean_names() |> 
  separate(mon,sep = "-", into = c("year","month","day")) |> 
  mutate(
    month = case_match(
      month,
      "01" ~ "Jan",
      "02" ~ "Feb",
      "03" ~ "Mar",
      "04" ~ "Apr",
      "05" ~ "May",
      "06" ~ "Jun",
      "07" ~ "Jul",
      "08" ~ "Aug",
      "09" ~ "Sep",
      "10" ~ "Oct",
      "11" ~ "Nov",
      "12" ~ "Dec"
    ) ) |> 
  mutate(
    president = case_match(
      prez_gop,
      1 ~ "gop",
      2 ~ "gop",
      0 ~ "dem"
  )) |> 
   select(-prez_dem, -prez_gop,-day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

- Cleaned pol-month dataset contains 822 observations of 9 variables
  related to the number of national politicians who are democratic or
  republican at any given time from 1947 to 2015.The variable
  *president* represents their partisanship.

Second, clean the data in *snp.csv* using a similar process to the
above.

``` r
snp_df =
  read_csv("./fivethirtyeight_datasets/snp.csv") |>
  janitor::clean_names() |> 
  separate(date,sep = "/", into = c("month","day","year")) |> 
  mutate(
    year = as.numeric(year),
    year = ifelse(year>=50, 1900+year, 2000+year)
  ) |> 
  relocate(year,month) |> 
  mutate(
    month = case_match(
      month,
      "1" ~ "Jan",
      "2" ~ "Feb",
      "3" ~ "Mar",
      "4" ~ "Apr",
      "5" ~ "May",
      "6" ~ "Jun",
      "7" ~ "Jul",
      "8" ~ "Aug",
      "9" ~ "Sep",
      "10" ~ "Oct",
      "11" ~ "Nov",
      "12" ~ "Dec"
    ) ) |> 
  select(-day)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

- Cleaned snp dataset contains 787 observations of 3 variables related
  to Standard & Poor’s stock market index (S&P), often used as a
  representative measure of stock market as a whole,from 1950 to 2015.
  The varibale *close* represents the closing values of the S&P stock
  index on the associated date.

Third, tidy the *unemployment data* so that it can be merged with the
previous datasets.

``` r
unemploy_df =
  read_csv("./fivethirtyeight_datasets/unemployment.csv") |>
    pivot_longer(
    Jan:Dec,
    names_to = "month", 
    values_to = "unemploy_rate"
  ) |> 
    janitor::clean_names() |> 
    mutate(year = as.numeric(year)) 
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

- Cleaned unemployment dataset contains 816 observations of 3 variables
  related to the unemployment rate in any given month from 1948 to 2015.

Finally,join the datasets by merging snp into pols, and merging
unemployment into the result.

``` r
result_df =
  pols_df |> 
  mutate(year = as.numeric(year)) |> 
  left_join(snp_df, by = join_by(year,month)) |> 
  left_join(unemploy_df, by = join_by(year,month))
```

- The result dataset contains 822 observations of 11 variables related
  all three parts of information above (including partisianship, S&P,
  unemployment rate) in any given month from 1947 to 2015.

## Problem 2

First, read and clean the Mr. Trash Wheel sheet

``` r
mr_df =
  readxl::read_excel("trashwheel_datasets/202207 Trash Wheel Collection Data.xlsx",sheet = "Mr. Trash Wheel",range = "A2:N550") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
    year = as.numeric(year),
    homes_powered = weight_tons * 500 /30,
    name = "mr"
  )
```

Next, use a similar process to import, clean, and organize the data for
Professor Trash Wheel and Gwynnda

``` r
professor_df =
  readxl::read_excel("trashwheel_datasets/202207 Trash Wheel Collection Data.xlsx",sheet = "Professor Trash Wheel",range = "A2:M97") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
    year = as.numeric(year),
    homes_powered = weight_tons * 500 /30,
    name = "professor"
  )
```

``` r
gwynnda_df =
  readxl::read_excel("trashwheel_datasets/202207 Trash Wheel Collection Data.xlsx",sheet = "Gwynnda Trash Wheel",range = "A2:K110") |> 
  janitor::clean_names() |> 
  drop_na(dumpster) |> 
  mutate(
    year = as.numeric(year),
    homes_powered = weight_tons * 500 /30,
    name = "gwynnda"
  )
```

Finally, combine these three dataset to produce a single tidy dataset

``` r
trashwheel_df =
  bind_rows(mr_df,professor_df,gwynnda_df) 
```

- The resulting `trashwheel_df` dataset is a combination of 3 datasets
  *Mr. Trash Wheel*, *Professor Trash Wheel*, and *Gwynnda Trash Wheel*
  . In total, the `trashwheel_df` dataset contains747 observations of 16
  variables, among which the `name` variable represent the trash wheel’s
  name. The resulting dataset contains 547 observations from *Mr. Trash
  Wheel* dataset, 94 observations from *Professor Trash Wheel* dataset,
  and 106 observations from *Gwynnda Trash Wheel* dataset. The resulting
  dataset contains key variables such as data (following `month`,
  `year`, `date` variables), and the workload of each trashwheel at a
  specific data (including the weight and volume of trash it collected
  `weight_tons` and `volume_cubic_yards`). It also contains amount of
  specific kind of trash that each trashwheel collected:
  `plastic_bottles`,`polystyrene`,`cigarette_butts`, `glass_bottles`,
  `grocery_bags`, `chip_bags`, `sports_balls` (which is only collected
  by Mr.Trash Wheel), `plastic_bags`(which is only collected by Gwynnda
  Trash Wheel). It also contains the (approximate) number of homes
  powered, `homes_powered`.

- Q: For available data, what was the total weight of trash collected by
  Professor Trash Wheel?

- A: The total weight of trash collected by Professor Trash Wheel is
  190.12

- Q:What was the total number of cigarette butts collected by Gwynnda in
  July of 2021?

- A: The total number of cigarette butts collected by Gwynnda in July of
  2021 is 1.63^{4}

## Problem 3

Import, clean, and tidy the dataset of baseline demographics. Ensure
that sex and APOE4 carrier status are appropriate encoded (i.e. not
numeric), and remove any participants who do not meet the stated
inclusion criteria (i.e. no MCI at baseline).

``` r
baseline_df =
  read_csv("./data_mci/MCI_baseline.csv",skip=1) |>
  janitor::clean_names() |> 
  mutate(
    sex = case_match(
      sex,
      1 ~ "Male",
      0 ~ "Female"
    ),
    apoe4 = case_match(
      apoe4,
      1 ~ "APOE4 carrier",
      0 ~ "APOE4 non-carrier"
    ),
    age_at_onset = replace(age_at_onset, age_at_onset == ".",NA)
)|> 
    filter(current_age < age_at_onset| is.na(age_at_onset) == 1)
```

    ## Rows: 483 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): Age at onset
    ## dbl (5): ID, Current Age, Sex, Education, apoe4
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

- To clean and tidy the dataset of baseline demographics, I first
  skipped the first row containing explanation of each variable of the
  dataset when I imported and then clean the names for convenience
  afterwards. Next, I use `case_match` function to change numeric values
  of variables `sex` and `apoe4` to characters of its meaning which is
  more appropriate to read. I further change the missing values `.` to
  `NA` in `age_at_onset` for conveience afterwards. Finally, I use
  `filter` function to remove any participants who do not meet the
  stated inclusion criteria (i.e. no MCI at baseline), which is either
  `current_age` less than `age_at_onset` or missing values in
  `age_at_onset`.

- After cleaning, the result dataset contains 479 observations of 6
  variables.

- Q: How many participants were recruited, and of these how many develop
  MCI?

- A: 483 participants were recruited, and 93 participants develop MCI.

- Q: What is the average baseline age?

- A: The baseline average age is 65.0286013.

- Q: What proportion of women in the study are APOE4 carriers?

- A: 30% of women in the study are APOE4 carriers.

Similarly, import, clean, and tidy the dataset of longitudinally
observed biomarker values; comment on the steps on the import process
and the features of the dataset.

``` r
amyloid_df =
  read_csv("./data_mci/mci_amyloid.csv",skip=1) |>
  janitor::clean_names() |> 
  mutate(
  baseline = replace(baseline, baseline == "Na", NA)
  ) |> 
  rename(id = study_id)
```

    ## Rows: 487 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (5): Baseline, Time 2, Time 4, Time 6, Time 8
    ## dbl (1): Study ID
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

- To clean and tidy the dataset of f longitudinally observed biomarker
  values, I first skipped the first row containing explanation of each
  variable of the dataset when I imported and then clean the names for
  convenience afterwards. Next,because the original data contains an
  observation with `Na` in `baseline`, I change it to `NA` for later
  convenience. Finally, I change the column name `study id` to `id` for
  convenient match of the other dataset afterwards.
- After cleaning, the result dataset contains 487 observations of 6
  variables.

Check whether some participants appear in only the baseline or amyloid
datasets, and comment on your findings.

``` r
id_baseline = pull(baseline_df, id)
id_amyloid = pull(amyloid_df, id)
id_baseline_only = id_baseline[!id_baseline %in% id_amyloid]
id_amyloid_only = id_amyloid[!id_amyloid %in% id_baseline]
```

- Participants14,49,92,179,268,304,389 and 412 only appear in the
  baseline dataset, while participants
  72,234,283,380,484,485,486,487,488,489,490,491,492,493,494 and 495
  only appear in the amyloid dataset.

Combine the demographic and biomarker datasets so that only participants
who appear in both datasets are retained, and briefly describe the
resulting dataset; export the result as a CSV to your data directory.

``` r
both_joined_df =
  inner_join(baseline_df, amyloid_df, join_by(id))
write_csv(both_joined_df, "data_mci/AD_biomarker.csv")
```

- The resulting dataset `both_joined_df` contains the data of 471
  participants that appear in both datasets, and the observation of 11
  variables. These variables including the basic demographic information
  of the participants (their`sex`,`current_age`,`education`). Their age
  of MCI onset `age_at_onset` and whether they are apoe4 carreier
  `apoe4`. It also includes the time (in years) elapsed since the study
  baseline to the visit where biomarker Amyloid \_ 42/40 ratio was
  measured: `baseline`, `time2`,`time4` ,`time6`,`time8`.
- The resulting dataset is exported as `AD_biomarker.csv`
